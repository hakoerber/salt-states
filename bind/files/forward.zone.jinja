$TTL {{ params.zoneinfo.ttl }}
@	{{ params.zoneinfo.class }}	SOA	{{ params.master.name }}. {{ params.zoneinfo.hostmaster }}.{{ params.domain }}. (
        {{ serial }}	;Serial
        {{ params.zoneinfo.refresh }}	;Refresh
        {{ params.zoneinfo.retry }}	;Retry
        {{ params.zoneinfo.expire }}	;Expire
        {{ params.zoneinfo.ttl }}	;Minimum TTL
)

@	IN	A	{{ params.master.ip }}

; nameservers
{% for nameserver in params.zoneinfo.nameservers %}
@	IN	NS	{{ nameserver.name }}.{{ params.domain }}.
{% endfor %}

; mailservers
{% for mailserver in params.zoneinfo.mailservers %}
@	IN	MX	{{ mailserver.priority }} {{ mailserver.name }}.{{ params.domain }}.
{% endfor %}

; common records
{% for record in params.zoneinfo.records|sort() %}
{% for arecord in record['dns']['arecords'] %}
{{ arecord }}.{{ params.domain }}.	IN	A	{{ record.ip }}
{% for subdomain in record['dns'].get('subdomains', []) %}
{{ subdomain }}.{{ arecord }}.{{ params.domain }}.	IN	A	{{ record.ip }}
{% endfor %}
{% endfor %}
{% for cname in record['dns'].get('cnames', []) %}
{{ cname }}.{{ params.domain }}.	IN	CNAME	{{ record['dns']['arecords'][0] }}.{{ params.domain }}.
{% for subdomain in record['dns'].get('subdomains', []) %}
{{ subdomain }}.{{ cname }}.{{ params.domain }}.	IN	CNAME	{{ record['dns']['arecords'][0] }}.{{ params.domain }}.
{% endfor %}
{% endfor %}

{% endfor %}

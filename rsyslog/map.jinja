{% set rsyslog = salt['grains.filter_by']({
    'RedHat': {
        'client': {
            'logs': {
                '*.info;mail.none;authpriv.none;cron.none': '/var/log/messages',
                'authpriv.*': '/var/log/secure',
                'mail.*': '/var/log/maillog',
                'cron.*': '/var/log/cron',
                '*.emerg': ':omusrmsg:*',
                'uucp,news.crit': '/var/log/spooler',
                'local7.*': '/var/log/boot.log',
            },
        },
    },
    'Debian': {
        'workdir': '/var/spool/rsyslog',
        'client': {
            'logs': {
                'autm,authpriv.*': '/var/log/auth.log',
                '*.*;auth,authpriv.none': '/var/log/syslog',
                'daemon.*': '/var/log/daemon.log',
                'kern.*': '/var/log/kern.log',
                'lpr.*': '/var/log/lpr.log',
                'mail.*': '/var/log/mail.log',
                'user.*': '/var/log/user.log',
                '*.=debug;auth,authpriv.none;news.none;mail.none': '/var/log/debug',
                '*.=info;*.=notice;*.=warn;auth,authpriv.none;cron,daemon.none;mail,news.none': '/var/log/messages',
                '*.emerg': ':omusrmsg:*',
            },
        },
    },
    'FreeBSD': {
        'workdir': '/var/spool/rsyslog',
        'service': 'rsyslogd',
        'conf': '/usr/local/etc/rsyslog.conf',
        'include_basedir': '/usr/local/etc/rsyslog.d',
        'client': {
            'logs': {
                '*.err;kern.warning;auth.notice;mail.crit': '/dev/console',
                '*.notice;authpriv.none;kern.debug;lpr.info;mail.crit;news.err': '/var/log/messages',
                'security.*': '/var/log/security',
                'auth.info;authpriv.info': '/var/log/auth.log',
                'mail.info': '/var/log/maillog',
                'lpr.info': '/var/log/lpd-errs',
                'ftp.info': '/var/log/xferlog',
                'cron.*':'/var/log/cron',
                '*.=debug': '/var/log/debug.log',
                '*.emerg': '*',
            },
        },
    },
    'default': {
        'package': 'rsyslog',
        'service': 'rsyslog',
        'workdir': '/var/lib/rsyslog',
        'conf': '/etc/rsyslog.conf',
        'include_basedir': '/etc/rsyslog.d',
        'client': {
            'include': [
                'syslog_forward.conf',
            ],
        },
    }
}, merge=salt['pillar.get']('rsyslog:lookup'), base='default') %}
